set previewer scope
set preview true
set hidden true
set drawbox true
set icons true
set ignorecase true

cmd open ${{
	case "$f" in
		*.org|*.tex) $VISUAL "$f" ;;
		*.jpg|*.png|*.gif) sxiv "$f" ;;
		*.mkv|*.mp3|*.mp4|*.flac|*.webp) vlc "$f" ;;
		*.pdf) zathura "$f" ;;
		*) $EDITOR "$f" ;;
	esac
}}

# Archive bindings
cmd unarchive ${{
	case "$f" in
		*.zip) unzip "$f" ;;
		*.tar.gz) tar -xzvf "$f" ;;
		*.tar.bz2) tar -xjvf "$f" ;;
		*.tar) tar -xvf "$f" ;;
		*) echo "Unsupported format" ;;
	esac
}}

# taken from Brodie
# github.com/BrodieRobertson/dotfiles
cmd trash_restore %trash-restore
cmd trash_clear %trash-empty
cmd trash ${{
	files=$(printf "$fx" | tr '\n' ';')
	while [ "$files" ]; do
		f=${files%%;*}

		trash-put "$(basename "$f")"

		if [ "$files" = "$f" ]; then
			files=''
		else
			files="${files#*;}"
		fi
	done
}}

cmd fzf_jump ${{
	res="$(find . -maxdepth 3 | fzf --reverse --header='Jump to location')"
	if [ -f "$res" ]; then
		cmd="select"
	elif [ -d "$res" ]; then
		cmd="cd"
	fi
	lf -remote "send $id $cmd \"$res\""
}}

# Capitalise beginning of a word
# Replace spaces with underscores
cmd rename_snake_pascal ${{
	echo "$fx" | while read l; do
		new="$(basename "$l" | sed 's/\(^[a-z]\| [a-z]\)/\U&/g ; s/ /_/g')"
		mv "$l" "$(pwd)/$new"
	done
}}

# Lowercase everything
# Replace spaces with underscores
cmd rename_snake_case ${{
	echo "$fx" | while read l; do
		new="$(basename "$l" | sed 's/[A-Z]/\L&/g ; s/ /_/g')"
		mv "$l" "$(pwd)/$new"
	done
}}

# Un-map
# map m
map w
map d
map r

# Rename
map rr rename
map rp rename_snake_case
map rm rename_snake_pascal
map rb $vimv $fx

# Backup
map bb $cp -r $f $f.bkp

# Trash
map dd trash
map dr trash_restore
map dc trash_clear

# Other
map . set hidden!
map p paste
map x cut
map y copy
map D delete
map dD delete
map <enter> open
map au unarchive
map e $$VISUAL "$f"
map J fzf_jump

# Shortcuts
map gc cd ~/.config
map grr cd ~/repos
map grd cd ~/repos/dotfiles
map grc cd ~/repos/cv
map grs cd ~/repos/scripts/scripts
map grn cd ~/repos/notes
map gp cd ~/Packt
map gh cd /mnt/HDD
map gw cd /mnt/WD
map gl cd ~/wallpapers
map gd cd ~/dev
